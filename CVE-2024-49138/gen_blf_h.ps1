$bytes = [System.IO.File]::ReadAllBytes('c:\Users\Admin\Desktop\Projects\LPE\blf_resource.bin')
$sb = [System.Text.StringBuilder]::new()
$sb.AppendLine('static const unsigned char g_blf_data[] = {') | Out-Null
for($i=0; $i -lt $bytes.Length; $i++) {
    $sb.Append(('0x{0:X2}' -f $bytes[$i])) | Out-Null
    if($i -lt $bytes.Length-1){ $sb.Append(',') | Out-Null }
    if(($i+1) % 20 -eq 0){ $sb.AppendLine() | Out-Null }
}
$sb.AppendLine('};') | Out-Null
$sb.AppendLine('static const unsigned int g_blf_size = sizeof(g_blf_data);') | Out-Null
[System.IO.File]::WriteAllText('c:\Users\Admin\Desktop\Projects\LPE\CVE-2024-49138\blf_data.h', $sb.ToString())
Write-Host "OK: blf_data.h size=$($sb.Length)"
